# This configmap contains the event sources configurations for Artifact gateway

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: build-event-source
  labels:
    # do not remove
    argo-events-event-source-version: v0.10
data:
  build: |-
    # bucket information
    bucket:
      # name of the bucket
      name: artifacts
    # s3 service endpoint
    endpoint: leanai-minio.default.svc.cluster.local:9000
    # list of events to subscribe to
    # Visit https://docs.minio.io/docs/minio-bucket-notification-guide.html
    events:
     - s3:ObjectCreated:Put
    # - s3:ObjectRemoved:Delete
    # Filters to apply on the key
    # Optional
    # e.g. filter for key that starts with "hello-" and ends with ".txt"
    filter:
      prefix: ""
      suffix: ".pyb"
    #TODO - change to listening to creation of classification-report.txt in directory instead
    # type of the connection
    insecure: true
    # accessKey refers to K8s secret that stores the access key
    accessKey:
      # Key within the K8s secret whose corresponding value (must be base64 encoded) is access key
      key: accesskey
      # Name of the K8s secret that contains the access key
      name: leanai-minio
    # secretKey contains information about K8s secret that stores the secret key
    secretKey:
      # Key within the K8s secret whose corresponding value (must be base64 encoded) is secret key
      key: secretkey
      # Name of the K8s secret that contains the secret key
      name: leanai-minio
